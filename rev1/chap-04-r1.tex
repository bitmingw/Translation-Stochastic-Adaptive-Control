\chapter{可控马尔可夫链模型} % Controlled Markov Chain Models

在本章将介绍有限可控马尔可夫模型下随机系统的一些基本结论。在观测和反馈法则只取决于反馈回路的情况下，状态过程被称为马尔可夫过程。本章将复习马尔可夫链的渐进性质，并简要介绍无限状态马尔可夫链。最后，本章将提出一个在某些情形下把一个连续时间马尔可夫过程转化为离散时间马尔可夫过程的方法。我们通过一个排序系统讲解此方法。

\section{一个例子}

迄今为止状态变量的取值范围均为$R^n$，但在很多情况下，让状态只能取一个有限集合的数值是更有利的。下面通过一个例子来说明。

有这样一台机器，在时刻$k$的状态由$x_k$来描述，$x_k$根据机器是否正常运转会返回1或者2。现在假定不允许从外界对机器施加控制，机器处于自治状态。若在$k$时刻机器正常运行，则$x_k = 1$，且它有一定的概率$q > 0$会在下一时刻出错，也就是$x_{k+1} = 2$,同时，有$1 - q$的概率它会维持正常运行的状态，即$x_{k+1} = 1$。若假设$q$与先前的状态$x_{k-1},...x_0$无关，并且出错的机器会一直保持错误的状态（当$x_k = 2$时$x_{k+1} = 2$的概率为1），则称$\{x_k, k \ge 0\}$是一个马尔可夫链。它的转移概率由矩阵$P = P\{P_ij\}$描述：
\begin{equation}
\begin{bmatrix}
1-q & q \\
0 & 1
\end{bmatrix}. \label{eq:4.1.1}
\end{equation}
转移概率矩阵的所有元素均为非负值，且每一行各元素之和为1，这样的矩阵又称为随机矩阵。

马尔可夫性质由下式表示：
\begin{equation}
Prob\{x_{k+1} = j \vert x_k = i, x_{k-1},...,x_0\} = P_ij, \quad i,j \in \{1,2\}. \label{eq:4.1.2}
\end{equation}

% ==== End of Page 35 ====

下面我们引入两个控制动作。设$u_k^1$是$k$时刻机器工作的强度。当机器停止工作，轻度工作和重度工作时$u_k^1$的值分别取0，1和2。假设机器的工作强度越高，它崩溃的可能性就越大。$u_k^2$表示维护机器所需的投入，假设它仅可以取值0或1，越大的值代表需要越多的维护。维护可以降低机器崩溃的概率，并使崩溃的机器恢复正常状态。

这两个控制的结果，可以用如下的控制转移概率建模。定义$u_k := (u_k^1, u_k^2)$，则
\begin{align}
P\{x_{k+1} = 2 \vert x_k = 1, x_{k-1},...,u_k,u_{k-1}...\} &= q_1(u_k^1) - q_2(u_k^2), \nonumber \\
P\{x_{k+1} = 1 \vert x_k = 1, x_{k-1},...,u_k,u_{k-1}...\} &= 1 - [q_1(u_k^1) - q_2(u_k^2)], \nonumber \\
P\{x_{k+1} = 1 \vert x_k = 2, x_{k-1},...,u_k,u_{k-1}...\} &= q_2(u_k^2), \nonumber \\
P\{x_{k+1} = 2 \vert x_k = 2, x_{k-1},...,u_k,u_{k-1}...\} &= 1 - q_2(u_k^2) \label{eq:4.1.3}
\end{align}
与公式\eqref{eq:4.1.1}类似，它们可以用一个矩阵表示，即控制$u$的函数：
\begin{equation}
P(u^1, u^2) = 
\begin{bmatrix}
1 - q_1(u^1) + q_2(u^2) & q_1(u^1) - q_2(u^2) \\
q_2(u^2) & 1 - q_2(u^2)
\end{bmatrix} \label{eq:4.1.4}
\end{equation}
公式\eqref{eq:4.1.3}可以用下面的状态图表示

\setlength{\unitlength}{1cm}
\thicklines
\begin{picture}(12,4)
\put(3.5,2){\circle{1}}
\put(3.4,1.9){$1$}
\put(8.5,2){\circle{1}}
\put(8.4,1.9){$2$}
\qbezier(3.9,2.4)(6,3.2)(8.1,2.4) % mid-upper curve
\put(7.9,2.45){\vector(4,-1){0.3}}
\put(5.6,3.3){$q_1 - q_2$}
\qbezier(3.9,1.6)(6,0.8)(8.1,1.6) % mid-lower curve
\put(4.1,1.55){\vector(-4,1){0.3}}
\put(5.9,0.5){$q_2$}
\qbezier(3.1,2.4)(1.5,2)(3.1,1.6) % left curve
\put(2.9,2.35){\vector(4,1){0.3}}
\put(0.2,1.9){$1 - [q_1 - q_2]$}
\qbezier(8.9,2.4)(10.5,2)(8.9,1.6) % right curve
\put(9.1,1.65){\vector(-4,-1){0.3}}
\put(10.5,1.9){$1 - q_2$}
\end{picture}

%==== End of Page 36 ====

其中，$q$的取值满足$q_1(0) < q_1(1) < q_1(2)$和$q_2(0) < q_2(1)$。这是因为轻度使用和维护得更好的机器比重度使用和维护不佳的机器崩溃的概率更低。另外，式\eqref{eq:4.1.3}中的最后两项概率与$u_k^1$无关，因为当机器已经崩溃时，它就无法被使用了。

假设系统受到一个时变的反馈指令$\{g_0,g_1,...\}$的作用，记$g_k \equiv g$，且另$u_k = g(x_k)$，则可得到转移概率矩阵$P_g = \{P_ij^g\}$，其中
\begin{equation}
P_ij^g := P_ij(g(i)), \quad i,j \in \{1,2\} \label{eq:4.1.5}
\end{equation}
例如，若$g(1) = (2,0), g(2) = (0,1)$，那么
\begin{equation}
P^g = 
\begin{bmatrix}
1 - q_1(2) + q_2(0) & q_1(2) - q_2(0) \\
q_2(1) & 1 - q_2(1)
\end{bmatrix} \label{eq:4.1.6}
\end{equation}

我们得到的结果$\{x_k\}$是一个具有静态转移概率$P^g$的马尔可夫链。$x_k$的概率分布可以写成行向量的形式
\begin{equation*}
p_k := (Prob\{x_k = 1\}, \ Prob\{x_k = 2\})
\end{equation*}
从马尔可夫的性质，公式\eqref{eq:4.1.3}可知
\begin{equation}
p_{k+m} = p_k[P^g]^m, \quad m \ge 0 \label{eq:4.1.7}
\end{equation}
特别地，
\begin{equation}
p_k = p_0[P^g]^k \label{eq:4.1.8}
\end{equation}
其中$p_0$是$x_0$的初始分布。

通常，当$k \to \infty$时，$p_k$收敛于与初始概率分布$p_0$无关的$p = (p(1),p(2))$，这时我们称它是一个具有各态历经性的马尔可夫链。概率分布的极限又称为稳态，平衡态，或不变分布。它是下面的线性方程的解：
\begin{equation}
p = p \ P^g, \quad p(1) + p(2) = 1 \label{eq:4.1.9}
\end{equation}
公式\eqref{eq:4.1.9}总有一个解。当马尔可夫链满足各态历经性时这个解是唯一的，且极限分布$p = (p(1),p(2))$可以用下式表示:
\begin{equation}
p(i) = \lim_{n \to \infty} \frac{1}{n} \sum_{k=1}^n I (x_k = i) \ wp \ 1 \label{eq:4.1.10}
\end{equation}
式中的$I$是指示函数，当$x_k = i$时$I(x_k = i) = 1$，当$x_k \ne i$时$I(x_k = i) = 0$。因此，$p(1)$是机器正常运转的时间的比例，$p(2)$是机器崩溃的时间的比例。

% ==== End of Page 37 ====

从式\eqref{eq:4.1.9}可以看出稳态概率$p$取决于反馈法则$g$。通过改变法则$g$，也就是改变使用和维护机器的时机，就可以调整机器崩溃的时间。但什么样的法则$g$可以导致最好的$p$呢？我们会在之后的章节进一步探讨这个问题。

\section{有限状态控制马尔可夫链}

前面的例子可以一般化成任意有限状态控制的马尔可夫链。它的状态$x_k$可取值$\{1,...I\}$。它的控制可以从一个有限或无限的集合$U$中取值。转移概率由一个$I \times I$的矩阵描述
\begin{equation}
u \to P(u) := \{P_ij(u), \quad 1 \le i,j \le I\} \label{eq:4.2.1}
\end{equation}
我们记
\begin{equation}
Prob\{x_{k+1} = j \vert x_k = i, x_{k-1},...,x_0,u_k,...,u_0\} = P_ij(u_k) \label{eq:4.2.2}
\end{equation}
矩阵$P(u)$的每个元素都是非负的，并且每一行的各个元素之和都是1，即矩阵$P(u)$是一个随机矩阵。同时，我们必须指定初始状态$x_0$的概率分布。当观测不等于状态，即$y_k \not\equiv x_k$，我们还需要指定观测概率
\begin{equation}
P(y \vert i) := Prob\{y_k = y \vert x_k = i\} \label{eq:4.2.3}
\end{equation}

\section{完全客观和马尔可夫策略}

考虑可控的马尔可夫链模型\eqref{eq:4.2.1}，若这个状态是可观测的，即$y_k \equiv x_k$，另$g = \{g_0,g_1,...\}$为一个反馈策略，使得$g_k$只与当前状态$x_k$有关。我们称这个策略$g$为马尔可夫策略。

若$g$是一个马尔可夫策略，且$\{x_k\}$是状态过程的结果，我们用一个$I$维的行向量表示$x_k$的概率分布：
\begin{equation*}
p_k^g := (Prob\{x_k = 1\},...,Prob\{x_k = I\})
\end{equation*}
上标$g$表示此分布由$g$决定，但在语义清楚时可以省略。

\begin{Lem} \label{Lem:4.3.1}
当我们运用了马尔可夫策略$g$的时候，状态过程的结果$\{x_k\}$就是一个马尔可夫过程。在$k$时刻它的一步转移概率为
% ==== End of Page 38 ====
\begin{equation*}
P_k^g := \{(P_k^g)_ij := P_ij (g_k(i)), \quad i \le i, j \le I\}
\end{equation*}
它的$m$步转移概率为
\begin{equation*}
P_k^g ... P_{k+m-1}^g
\end{equation*}
矩阵中第$ij$个元素是当$k$时刻它的状态为$i$的条件下$k+m$时刻它的状态为$j$的概率。即
\begin{equation*}
p_{k+m} = p_k \ P_k^g ... P_{k+m-1}^g
\end{equation*}
特别地，
\begin{equation}
p_k = p_0 \ P_0^g ... P_{k-1}^g \label{eq:4.3.2}
\end{equation}
其中$p_0$是初始状态$x_0$的概率分布。
\end{Lem}

\begin{Prf}
从马尔可夫的性质\eqref{eq:4.2.2}直接得证。
\end{Prf}

由于转移概率矩阵只取决于时间$k$，因此我们说$\{x_k\}$是一个具有非静态转移概率的马尔可夫链。

\section{马尔可夫策略的成本}

马尔可夫策略$g$决定了状态过程$\{x_k\}$的概率分布和控制过程$\{u_k = g_k(x_k)\}$。不同的策略会导致不同的概率分布。在最优控制中，我们希望找到最好的策略，这需要通过比较多种策略才能得出。我们为此定义了代价函数，它是一系列和状态与控制相关的实值函数
\begin{equation*}
c_k(i,u), \quad 1 \le i \le I, \quad u \in U, \quad k \ge 0
\end{equation*}
它表示$c_k{i,u}$是$k$时刻当$x_k = i$和$u_k = u$时的代价。

对于一个固定的马尔可夫策略$g$，到$N$时刻积累的代价为$\sum_{k=0}^N c_k(x_k,u_k)$。因为$x_k$和$u_k$是随机的，所以它是一个随机变量。积累的代价的均值为
\begin{equation}
J(g) := E^g \ \sum_{k=0}^N c_k(x_k,u_k) \ = \ E^g \ \sum_{k=0}^N c_k(x_k,g_k(x_k)) \label{eq:4.4.1}
\end{equation}
此处的$E^g$代表由$g$决定的$\{x_k\}$和$\{u_k\}$的概率分布。

$J(g)$可以通过转移概率矩阵$P_k^g$算出。从公式\eqref{eq:4.4.1}可以得到
\begin{align}
J(g) &= \sum_{k=0}^N \sum_{i=1}^I Prob\{x_k = i\} \ c_k(i,g_k(i)) \nonumber \\
% ==== End of Page 39 ====
&= \sum_{k=0}^N p_k c_k^g = \sum_{k=0}^N p_0 (P_0^g ... P_{k-1}^g) c_k^g \label{eq:4.4.2}
\end{align}
其中$c_k^g$是$I$维的列向量
\begin{equation}
c_k^g := (c_k(1,g(1)),...,c_k(I,g(I)))^T \label{eq:4.4.3}
\end{equation}
式\eqref{eq:4.4.2}中的最后一步推导用到了\eqref{eq:4.3.2}。

最佳的马尔可夫策略$g$可以使$J(g) = \sum_{k=0}^N p_0 (P_0^g ... P_{k-1}^g) c_k^g$取最小值。在第五章我们将通过学习动态规划来计算最佳的$g$。

动态规划是一个用递归方式计算最佳$g$的方法。由于这个方法只取决于下面的事实：由$g$决定的状态过程是马尔可夫的，因此我们在这里加以介绍。对任意时间$1 \le k \le N$以及状态$1 \le i \le I$，令$V_k^g(i)$代表当$x_k = i$时$k,...N$阶段代价的期望。也就是说
\begin{equation}
V_k^g(i) := E^g \ \{\sum_{l=k}^N c_l (x_l,g_l(x_l)) \vert x_k = i\} \label{eq:4.4.4}
\end{equation}
因此所有的代价可以表示为
\begin{equation}
J(g) = \sum_{i=1}^I (p_0)_i V_0^g (i) \label{eq:4.4.5}
\end{equation}

\begin{Lem} \label{Lem:4.4.6}
函数$V_k^g(i)$可以通过向后递归的方式计算：
\begin{equation}
V_k^g(i) = c_k(i,g_k(i)) + \sum_{j=1}^I (P_k^g)_ij V_{k+1}^g(j), \quad 0 \le k < N \label{eq:4.4.7}
\end{equation}
其初始条件是
\begin{equation}
V_N^g(i) = c_N(i,g_N(i)) \label{eq:4.4.8}
\end{equation}
\end{Lem}

\begin{Prf}
从定义中我们立即可得\eqref{eq:4.4.8}，之后
\begin{align*}
V_k^g(i) &= E^g \ \{\sum_{l=k}^N c_l(x_l,g_l(x_l)) \vert x_k = i\} \\
&= c_k(i,g_k(i)) + E^g \ \{E^g \ \{\sum_{l=k+1}^N c_l(x_l,g_l(x_l)) \vert x_{k+1},x_k = i\} \vert x_k = i\} \\
% ==== End of Page 40 ====
&= c_k(i,g_k(i)) + E^g \ \{V_{k+1}^g(x_{k+1}) \vert x_k = i\}, \quad by \eqref{eq:4.2.2} \\
&= c_k(ig_k(i)) + \sum_{j=1}^I V_{k+1}^g(j) Prob\{x_{k+1} \vert x_k = i\}
\end{align*}
由$(P_k^g)_{ij}$可看出，这就是\eqref{eq:4.4.7}的结果。
\end{Prf}

前面的公式可以用向量的形式更方便地表达，我们设$I$维的列向量
\begin{equation}
V_k^g := (V_k^g(1),...,V_k^g(I))^T \label{eq:4.4.9}
\end{equation}
则用\eqref{eq:4.4.3}可以分别表达\eqref{eq:4.4.7}，\eqref{eq:4.4.8}和\eqref{eq:4.4.5}如下
\begin{align}
V_k^g &= c_k^g + P_k^g V_{k+1}^g, \quad 0 \le k < N \label{eq:4.4.10} \\
V_N^g &= c_N^g \label{eq:4.4.11} \\
J(g) &= p_0 \ V_0^g \label{eq:4.4.12}
\end{align}

这里的时间长度$N$是有限的，但有时我们需要研究时间为无限长时的情况。这不是一个立即可得的扩充，因为如果直接将\eqref{eq:4.4.1}中的$N = \infty$，在大多数情况下对任意$g$会有$J(g) = \infty$，所以最好的$g$也就失去了意义。有两个途径可以解决无限时间的问题。

第一个方法是引入一个衰减因子$\beta, 0 < \beta < 1$，并计算衰减代价的期望
\begin{equation*}
J(g) = E^g \sum_{k=0}^{\infty} \beta^k c_k(x_k,u_k)
\end{equation*}
只要$c_k$是有界的，$J(g)$就是有限的。因为在$k$时刻的代价衰减了$\beta^k$，所以现在的代价比未来的代价更为重要。例如，在经济问题中，设$\beta = (1+r)^{-1}$，其中$r > 0$是利率。在这种表示中，$J(g)$是当前的代价，从\eqref{eq:4.4.2}可知
\begin{equation*}
J(g) = \sum_{k=0}^{\infty} \beta^k p_0 (P_0^g ... P_{k-1}^g) c_k^g
\end{equation*}
若定义
\begin{equation*}
V_k^g(i) := E^g \ \{\sum_{l=k}^{\infty} \beta^l c_l(x_l,g_l(x_l)) \vert x_k = i\}
\end{equation*}
使用\eqref{eq:4.4.9}中的记法，式\eqref{eq:4.4.10}和\eqref{eq:4.4.12}可以写为
\begin{align}
V_k^g &= \beta^k c_k^g + P_k^g V_{k+1}^g, \quad k \ge 0 \label{eq:4.4.13} \\
% ==== End of Page 41 ====
J(g) &= p_0 \ V_0^g \nonumber
\end{align}
但是，在无限时间问题中，式\eqref{eq:4.4.11}没有对应的公式。

第二个方法可以在衰减不适用的情况下使用。此时，马尔可夫策略通过单位时间内的平均代价来衡量
\begin{equation}
J(g) = \lim_{N \to \infty} \frac{1}{N} E^g \ \sum_{k=0}^{N-1} c_k(x_k,g_k(x_k)) \label{eq:4.4.14}
\end{equation}
通过\eqref{eq:4.4.2}式可知其代价等于
\begin{equation}
\lim_{N \to \infty} \frac{1}{N} \sum_{k=0}^{N-1} p_0 (P_0^g ... P_{k-1}^g) c_k^g \label{eq:4.4.15}
\end{equation}
从上面的表达式可以看出，$P_k^g$是随$k$的变化而变化的，因此极限不一定存在。如果转移概率矩阵与$k$无关，则极限始终存在。

到目前为止，式\eqref{eq:4.4.1}表达的总代价是每个时刻的代价的累加。下面的练习会证明，其他的代价函数也可以写成累加的形式。

\begin{Exe} \label{Exe:4.4.16}
假设马尔可夫策略$g := \{g_0,...,g_n\}$的代价是
\begin{equation}
J(g) := E^g \ I(\max_{0 \le k \le N} h(x_k) \ge \alpha) \label{eq:4.4.17}
\end{equation}
其中$I$是指示函数，$h$和$\alpha$的定义如前。（$J(g)$是$h(x_k)$的值在$k$时刻大于$\alpha$的概率。）试证明\eqref{eq:4.4.17}可以写成\eqref{eq:4.4.1}那样累加的形式。
【提示：定义一个新的马尔可夫链$z_k := (x_k,y_k), y_k \in \{0,1\}$。$x_k$的转移概率没有变化，因此
\begin{align*}
Prob\{y_{k+1} = 1 \vert y_k = 0,x_k,z_{k-1},...,z_0,u_k,...,u_0\} \\
=
\begin{cases}
1 & \text{if } h(x_k) \ge \alpha \\
0 & \text{if } h(x_k) < \alpha
\end{cases} \\
Prob\{y_{k+1} = 1 \vert y_k = 1,x_k,z_{k-1},...,z_0,u_k,...,u+0\} \equiv 1
\end{align*}
再设$c_k(z,u) \equiv 0, k < N$和$c_N(x,y,u) \equiv y$
】
\end{Exe}

\section{静态马尔可夫策略}

一个马尔可夫策略$g = \{g_0,g_1,...\}$称为静态的或者时不变的，如果$g_0 \equiv g_1 \equiv ... \equiv g$。

如果$g$是静态的，则转移概率矩阵也是静态的，$P_k^g \equiv P^g$。若假设代价函数也是时不变的，即$c_k = c$，设衰减因子$0 < \beta < 1$为一个固定值，则
% ==== End of Page 42 ====
\begin{align*}
V_k^g(i) &= E^g \ \{\sum_{l=k}^{\infty} \beta^l c(x_l,g(x_l)) \vert x_k = i\} \\
&= \beta^k E^g \{\sum_{l=0}^{\infty} \beta^l c(x_l,g(x_l)) \vert x_0 = i\} \\
&= \beta^k V_0^g(i)
\end{align*}
带入\eqref{eq:4.4.13}中可得
\begin{equation*}
\beta^k V_0^g = \beta^k c^g + \beta^{k+1} P^g V_0^g
\end{equation*}
或者用矩阵表示为
\begin{equation*}
[I - \beta P^g] V_0^g = c^g
\end{equation*}
这是一组共$I$个线性方程，$V_0^g(i)$中有$I$个未知量。练习\eqref{Exe:4.5.3}说明$[I - \beta P^g]$是可逆的，因此这个系统的线性方程有唯一解$V_0^g$。

\begin{Exe} \label{Exe:4.5.1}
定义$x \in R^I$的模为$\vert x \vert := \max \{\vert x_1 \vert,...\vert x_I \vert\}$。定义$I \times I$的矩阵$P$的模为$\Vert P \Vert := \max_i \sum_j \vert P_ij \vert$。证明矩阵的模可由向量的模推导出来
\begin{equation*}
\Vert P \Vert = \max_{x \ne 0} \frac{\vert P_x \vert}{\vert x \vert}
\end{equation*}
并且$\Vert PQ \Vert \le \Vert P \Vert \Vert Q \Vert$
\end{Exe}

\begin{Exe} \label{Exe:4.5.2}
$I \times I$的矩阵$P$，当$P_ij \ge 0$且$\sum_j P_ij = 1$时是一个转移概率矩阵（随机矩阵）。证明$\Vert P \Vert = 1$。
\end{Exe}

\begin{Exe} \label{Exe:4.5.3}
$P$是一个转移概率矩阵，$0 < \beta < 1$，证明$I - \beta P$是可逆的。事实上，
\begin{equation*}
[I - \beta P]^{-1} = \lim_{n \to \infty} \sum_{k=0}^n [\beta P]^k
\end{equation*}
由于$\Vert P \Vert = 1$，因此公式右侧的无穷项的和存在。对一个固定值$c$和$V(0)$，按下面的办法生成序列$V(n)$
\begin{equation*}
V(n+1) := c + \beta P V(n)
\end{equation*}
试证明当$n \to \infty$时$V(n) \to [I - \beta P]^{-1}$
【提示：递归带入$V(n)$的表达式。】
\end{Exe}

% ==== End of Page 43 ====

下面我们将研究当$g$和$c$都不变时\eqref{eq:4.4.14}和\eqref{eq:4.4.15}的平均代价。我们不加证明地提出了下面三个引理。

\begin{Lem} \label{Lem:4.5.4}
如果$P$是转移概率矩阵，则塞萨罗极限
\begin{equation}
\lim_{N \to \infty} \frac{1}{N} \sum_{k=0}^{N-1} P^k =: \Pi
\end{equation}
总是存在的。矩阵$\Pi$是一个随机矩阵，且满足如下的性质
\begin{equation}
\Pi = \Pi P
\end{equation}
\end{Lem}

因此对静态的$g$和时不变的代价函数，式\eqref{eq:4.4.14}和\eqref{eq:4.4.15}的单位时间平均代价为
\begin{equation}
J(g) = \lim_{N \to \infty} \frac{1}{N} E^g \sum_{k=0}^{N-1} c(x_k,g(x_k)) = p_0 \Pi c^g \label{eq:4.5.5}
\end{equation}

若$\pi$是$\Pi$中的一行，则下式也成立
\begin{equation*}
\pi = \pi P
\end{equation*}
另外，由于$\Pi$是随机矩阵，$\pi$可以视为概率分布。如果马尔可夫链的初始概率分布是$\pi$，那么状态的概率分布将一直保持为$\pi$。因此$\pi$又称为不变概率分布。如果$\Pi$并非每一行都相同，则存在多于一个不变概率分布。

\begin{Exe} \label{Exe:4.5.6}
举一个例子说明式\eqref{eq:4.5.5}中$J(g)$于$p_0$有关。
【提示：选取$P = I$，此处有多个不变概率分布。】
\end{Exe}

在很多情况下\eqref{eq:4.5.5}与初始分布$p_0$无关。一个$I \times I$的转移概率矩阵$P$是可约的或可分解的，如果存在状态的重编号$\{1,...I\}$，使$P$可以写成这种形式
\begin{equation*}
P = 
\begin{bmatrix}
P_1 & P_2 \\
0 & P_3
\end{bmatrix}
\end{equation*}
其中$P_1$和$P_3$是方阵。这说明不可能从$P_3$中的某一行的状态转变成$P_1$中对应的状态。因此如果初始状态属于$P_3$中各行状态的集合，则马尔可夫链不会跳出这个集合，它的转移概率由$P_3$决定。这是一个具有更小的状态空间的马尔可夫链。

% ==== End of Page 44 ====

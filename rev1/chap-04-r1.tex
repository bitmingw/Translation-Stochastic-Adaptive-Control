\chapter{可控马尔可夫链模型} % Controlled Markov Chain Models

在本章将介绍有限可控马尔可夫模型下随机系统的一些基本结论。在观测和反馈法则只取决于反馈回路的情况下，状态过程被称为马尔可夫过程。本章将复习马尔可夫链的渐进性质，并简要介绍无限状态马尔可夫链。最后，本章将提出一个在某些情形下把一个连续时间马尔可夫过程转化为离散时间马尔可夫过程的方法。我们通过一个排序系统讲解此方法。

\section{一个例子}

迄今为止状态变量的取值范围均为$R^n$，但在很多情况下，让状态只能取一个有限集合的数值是更有利的。下面通过一个例子来说明。

有这样一台机器，在时刻$k$的状态由$x_k$来描述，$x_k$根据机器是否正常运转会返回1或者2。现在假定不允许从外界对机器施加控制，机器处于自治状态。若在$k$时刻机器正常运行，则$x_k = 1$，且它有一定的概率$q > 0$会在下一时刻出错，也就是$x_{k+1} = 2$,同时，有$1 - q$的概率它会维持正常运行的状态，即$x_{k+1} = 1$。若假设$q$与先前的状态$x_{k-1},...x_0$无关，并且出错的机器会一直保持错误的状态（当$x_k = 2$时$x_{k+1} = 2$的概率为1），则称$\{x_k, k \ge 0\}$是一个马尔可夫链。它的转移概率由矩阵$P = P\{P_ij\}$描述：
\begin{equation}
\begin{bmatrix}
1-q & q \\
0 & 1
\end{bmatrix}. \label{eq:4.1.1}
\end{equation}
转移概率矩阵的所有元素均为非负值，且每一行各元素之和为1，这样的矩阵又称为随机矩阵。

马尔可夫性质由下式表示：
\begin{equation}
Prob\{x_{k+1} = j \vert x_k = i, x_{k-1},...,x_0\} = P_ij, \quad i,j \in \{1,2\}. \label{eq:4.1.2}
\end{equation}

% ==== End of Page 35 ====

下面我们引入两个控制动作。设$u_k^1$是$k$时刻机器工作的强度。当机器停止工作，轻度工作和重度工作时$u_k^1$的值分别取0，1和2。假设机器的工作强度越高，它崩溃的可能性就越大。$u_k^2$表示维护机器所需的投入，假设它仅可以取值0或1，越大的值代表需要越多的维护。维护可以降低机器崩溃的概率，并使崩溃的机器恢复正常状态。

这两个控制的结果，可以用如下的控制转移概率建模。定义$u_k := (u_k^1, u_k^2)$，则
\begin{align}
P\{x_{k+1} = 2 \vert x_k = 1, x_{k-1},...,u_k,u_{k-1}...\} &= q_1(u_k^1) - q_2(u_k^2), \nonumber \\
P\{x_{k+1} = 1 \vert x_k = 1, x_{k-1},...,u_k,u_{k-1}...\} &= 1 - [q_1(u_k^1) - q_2(u_k^2)], \nonumber \\
P\{x_{k+1} = 1 \vert x_k = 2, x_{k-1},...,u_k,u_{k-1}...\} &= q_2(u_k^2), \nonumber \\
P\{x_{k+1} = 2 \vert x_k = 2, x_{k-1},...,u_k,u_{k-1}...\} &= 1 - q_2(u_k^2) \label{eq:4.1.3}
\end{align}
与公式\eqref{eq:4.1.1}类似，它们可以用一个矩阵表示，即控制$u$的函数：
\begin{equation}
P(u^1, u^2) = 
\begin{bmatrix}
1 - q_1(u^1) + q_2(u^2) & q_1(u^1) - q_2(u^2) \\
q_2(u^2) & 1 - q_2(u^2)
\end{bmatrix} \label{eq:4.1.4}
\end{equation}
公式\eqref{eq:4.1.3}可以用下面的状态图表示

\setlength{\unitlength}{1cm}
\thicklines
\begin{picture}(12,4)
\put(3.5,2){\circle{1}}
\put(3.4,1.9){$1$}
\put(8.5,2){\circle{1}}
\put(8.4,1.9){$2$}
\qbezier(3.9,2.4)(6,3.2)(8.1,2.4) % mid-upper curve
\put(7.9,2.45){\vector(4,-1){0.3}}
\put(5.6,3.3){$q_1 - q_2$}
\qbezier(3.9,1.6)(6,0.8)(8.1,1.6) % mid-lower curve
\put(4.1,1.55){\vector(-4,1){0.3}}
\put(5.9,0.5){$q_2$}
\qbezier(3.1,2.4)(1.5,2)(3.1,1.6) % left curve
\put(2.9,2.35){\vector(4,1){0.3}}
\put(0.2,1.9){$1 - [q_1 - q_2]$}
\qbezier(8.9,2.4)(10.5,2)(8.9,1.6) % right curve
\put(9.1,1.65){\vector(-4,-1){0.3}}
\put(10.5,1.9){$1 - q_2$}
\end{picture}

%==== End of Page 36 ====

其中，$q$的取值满足$q_1(0) < q_1(1) < q_1(2)$和$q_2(0) < q_2(1)$。这是因为轻度使用和维护得更好的机器比重度使用和维护不佳的机器崩溃的概率更低。另外，式\eqref{eq:4.1.3}中的最后两项概率与$u_k^1$无关，因为当机器已经崩溃时，它就无法被使用了。

假设系统受到一个时变的反馈指令$\{g_0,g_1,...\}$的作用，记$g_k \equiv g$，且另$u_k = g(x_k)$，则可得到转移概率矩阵$P_g = \{P_ij^g\}$，其中
\begin{equation}
P_ij^g := P_ij(g(i)), \quad i,j \in \{1,2\} \label{eq:4.1.5}
\end{equation}
例如，若$g(1) = (2,0), g(2) = (0,1)$，那么
\begin{equation}
P^g = 
\begin{bmatrix}
1 - q_1(2) + q_2(0) & q_1(2) - q_2(0) \\
q_2(1) & 1 - q_2(1)
\end{bmatrix} \label{eq:4.1.6}
\end{equation}

我们得到的结果$\{x_k\}$是一个具有静态转移概率$P^g$的马尔可夫链。$x_k$的概率分布可以写成行向量的形式
\begin{equation*}
p_k := (Prob\{x_k = 1\}, \ Prob\{x_k = 2\})
\end{equation*}
从马尔可夫的性质，公式\eqref{eq:4.1.3}可知
\begin{equation}
p_{k+m} = p_k[P^g]^m, \quad m \ge 0 \label{eq:4.1.7}
\end{equation}
特别地，
\begin{equation}
p_k = p_0[P^g]^k \label{eq:4.1.8}
\end{equation}
其中$p_0$是$x_0$的初始分布。

通常，当$k \to \infty$时，$p_k$收敛于与初始概率分布$p_0$无关的$p = (p(1),p(2))$，这时我们称它是一个具有各态历经性的马尔可夫链。概率分布的极限又称为稳态，平衡态，或不变分布。它是下面的线性方程的解：
\begin{equation}
p = p \ P^g, \quad p(1) + p(2) = 1 \label{eq:4.1.9}
\end{equation}
公式\eqref{eq:4.1.9}总有一个解。当马尔可夫链满足各态历经性时这个解是唯一的，且极限分布$p = (p(1),p(2))$可以用下式表示:
\begin{equation}
p(i) = \lim_{n \to \infty} \frac{1}{n} \sum_{k=1}^n I (x_k = i) \ wp \ 1 \label{eq:4.1.10}
\end{equation}
式中的$I$是指示函数，当$x_k = i$时$I(x_k = i) = 1$，当$x_k \ne i$时$I(x_k = i) = 0$。因此，$p(1)$是机器正常运转的时间的比例，$p(2)$是机器崩溃的时间的比例。

% ==== End of Page 37 ====

从式\eqref{eq:4.1.9}可以看出稳态概率$p$取决于反馈法则$g$。通过改变法则$g$，也就是改变使用和维护机器的时机，就可以调整机器崩溃的时间。但什么样的法则$g$可以导致最好的$p$呢？我们会在之后的章节进一步探讨这个问题。

\section{有限状态控制马尔可夫链}
